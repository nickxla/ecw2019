#!/usr/bin/python

import requests
import json
from cryptography.hazmat.primitives import serialization
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import padding
from cryptography.hazmat.backends import default_backend

with open('key.pub','rb') as key:
    pub = serialization.load_pem_public_key(
            key.read(),
            backend=default_backend()
    )

email = ""
passwd = ""

dico = {
    "email":email,
    "passwd":passwd
}

stringified = json.dumps(dico)
print(stringified + "\n")

enc = pub.encrypt(stringified,
        padding.OAEP(
            mgf=padding.MGF1(algorithm=hashes.SHA256()),
            algorithm=hashes.SHA256(),
            label=None
        )
    )

print(enc)
