#!/usr/bin/python

import requests as r
from pyquery import PyQuery as pq

def auth(s):
    authpage = s.get('https://www.challenge-ecw.fr/login')
    nonce = getValue(authpage.text,'input[name="nonce"]')
    s.post('https://www.challenge-ecw.fr/login', data = { 'pseudo':'ncpd', 'password':'9vdzUyxYc#!vs4zdeR', 'nonce': nonce })

def getValue(html, selector):
    dom = pq(html)
    return dom(selector).attr('value')

s = r.session()
auth(s)

bazar = s.options('https://web_0daybazar.challenge-ecw.fr/enroll')
print(bazar.headers)
print(bazar.text)
